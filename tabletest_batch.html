<style type="text/css">
.tg  {border-collapse:collapse;border-spacing:0;border-width:1px;border-style:solid;border-color:black;}
.tg td{font-family:Arial, sans-serif;font-size:14px;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;}
.tg th{font-family:Arial, sans-serif;font-size:14px;font-weight:normal;padding:10px 5px;border-style:solid;border-width:0px;overflow:hidden;word-break:normal;}
.tg .tg-l6li{font-size:12px;border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-0pky{border-color:inherit;text-align:left;vertical-align:top}
.tg .tg-0pkx{border-color:inherit;text-align:left;vertical-align:bottom}
</style>
<div id="labels"></div>
<script>
  const remote = require('electron').remote;
  const app = remote.app;
  var fs = require('fs');
  const path = require("path");
  const userData = app.getPath('userData');
  var parsedjson = JSON.parse(fs.readFileSync(path.resolve(__dirname, userData + "/chemikalie_json.json")));
  var parsedconfig = JSON.parse(fs.readFileSync(path.resolve(__dirname, userData + "/config.json")));
  //data = JSON.parse(localStorage["data"]);
  var tablestruc = '<table class="tg" style="undefined;table-layout: fixed; width: 402px"><colgroup><col style="width: 170px; height: 170px"><col style="width: 225px"></colgroup><tr><th class="tg-0pky" id="qr" rowspan="2"></th><th class="tg-l6li" id="nazev"><br></th></tr><tr><td class="tg-0pkx" id="pictograms"></td></tr></table>'
  var printids = JSON.parse(localStorage["printids"]);
  localStorage["printids"] = "";
  for (i = 0; i < printids.length; i++) {
    console.log("hello");
    var x = parsedjson["Chemikalie"][printids[i]];
    document.getElementById("labels").innerHTML += tablestruc;
    var data = {
      nazev: "<h2>" + x["nazev"] + "</h2>",
      cistota: x["cistota"],
      poznamkaraw: x["poznamkaraw"],
      qrtag: "",
      pictograms: "",
      molarnih: ""
    }
    var qrurl;
    if (typeof parsedconfig.weburl !== "undefined") {
      qrurl = 'https://api.qrserver.com/v1/create-qr-code/?data=' + 'http://' + parsedconfig.weburl + '/index_access.html?index=' + printids[i] + '&amp;size=50x50';
    } else {
      qrurl = 'graphics/qr_error.png'
    }
    data.qrtag = '<img id="qrhere" src="' + qrurl + '" height="150" width="150">'
    var pictograms = [x["explosive"], x["flammable"], x["oxidising"], x["gasunderpressure"], x["corrosive"], x["toxicity"], x["health"], x["chronichealth"], x["environmental"]];
    var pictonumbers = [13, 15, 17, 19, 21, 23, 25, 27, 29];
    for (y = 0; y < pictograms.length; y++) {
      if (pictograms[y] != 0) {
        data.pictograms += "<img src='graphics/pictograms/" + pictonumbers[y] + ".svg' height='50px' width='50px'>";
      }
    }
    document.getElementById("nazev").innerHTML = data.nazev
    document.getElementById("nazev").innerHTML += data.molarnih;
    document.getElementById("nazev").innerHTML += "<br>" + data.cistota;
    if (data.poznamkaraw != undefined) {
      document.getElementById("nazev").innerHTML += "<br>" + data.poznamkaraw;
    }
    document.getElementById("nazev").id = "";
    document.getElementById("qr").innerHTML = data.qrtag;
    document.getElementById("qr").id = "";
    document.getElementById("pictograms").innerHTML = data.pictograms;
    document.getElementById("pictograms").id = "";
    document.getElementById("labels").innerHTML += "<br>";
  }
  window.print();
</script>
